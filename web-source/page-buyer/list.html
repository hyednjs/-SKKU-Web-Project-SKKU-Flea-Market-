<!DOCTYPE html>
<html lang="en">

<head>
	<title>SKKU Flea Market</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" href="../img/Favicon.png" type="image/png">
	<link rel="stylesheet" type="text/css" href="../css/util.css">
	<link rel="stylesheet" type="text/css" href="../css/list.css">
	<link rel="stylesheet" href="../vendors/bootstrap/bootstrap.min.css">
	<link rel="stylesheet" href="../vendors/fontawesome/css/all.min.css">
	<link rel="stylesheet" href="../vendors/themify-icons/themify-icons.css">
	<link rel="stylesheet" href="../vendors/linericon/style.css">
	<link rel="stylesheet" href="../vendors/owl-carousel/owl.theme.default.min.css">
	<link rel="stylesheet" href="../vendors/owl-carousel/owl.carousel.min.css">
	<link rel="stylesheet" href="../vendors/nice-select/nice-select.css">
	<link rel="stylesheet" href="../vendors/nouislider/nouislider.min.css">
	<link rel="stylesheet" href="../css/style.css">
	<!--===============================================================================================-->
</head>

<body>
	<!--================ Start Header Menu Area =================-->
	<header class="header_area">
		<div class="main_menu">
			<nav class="navbar navbar-expand-lg navbar-light">
				<div class="container">
					<a class="navbar-brand logo_h" href="index.html"><img src="../img/logo.png" alt=""></a>
					<h6>___for Buyer</h6>
					<button class="navbar-toggler" type="button" data-toggle="collapse"
						data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
						aria-expanded="false" aria-label="Toggle navigation">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<div class="collapse navbar-collapse offset" id="navbarSupportedContent">
						<ul class="nav navbar-nav menu_nav ml-auto mr-auto">
							<li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
							<li class="nav-item"><a class="nav-link" href="list.html">Product List</a></li>
							<li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
						</ul>

						<ul class="nav-shop">
							<li class="nav-item"><button><i class="ti-shopping-cart"></i><span
										class="nav-shop__circle"></span></button> </li>
							<li class="nav-item"><a class="button button-header" href="../login.html">Log out</a></li>
						</ul>
					</div>
				</div>
			</nav>
		</div>
	</header>
	<!--================ End Header Menu Area =================-->

	<!-- ================ start banner area ================= -->
	<section class="blog-banner-area" id="contact">
		<div class="container h-100">
			<div class="blog-banner">
				<div class="text-center">
					<h1>Product List</h1>
					<nav aria-label="breadcrumb" class="banner-breadcrumb">
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="index.html">Home</a></li>
							<li class="breadcrumb-item active" aria-current="page">Product List</li>
						</ol>
					</nav>
				</div>
			</div>
		</div>
	</section>
	<!-- ================ end banner area ================= -->
	<!-- Start Filter Bar -->
	<section class="section-margin--small mb-5">
		<div class="container">
			<div class="row">
				<div class="col-xl-12 col-lg-10 col-md-8">
					<div class="filter-bar d-flex flex-wrap align-items-center">

						<div class="common-filter">
							<div class="head">Search by Price</div>
							<div class="price-range-area">
								<div id="price-range"></div>
								<div class="value-wrapper d-flex">
									<div class="price">Price: </div>
									<input type="text" id="min_price" value="0">
									<div id="lower-value" onchanged="alert('helo')"></div>
									<div class="to">to</div>
									<input type="text" id="max_price" value="999999">
									<div id="upper-value"></div>
								</div>
							</div>
						</div>
						<div>
							<div class="input-group filter-bar-search">
								<!--input type="text" placeholder="Search"-->
								<!--div class="input-group-append"-->
								<button type="button" id="search" onClick="search(this)"><i
										class="ti-search"></i></button>
								<!--/div>-->
							</div>
						</div>
					</div>
					<!-- End Filter Bar -->
					<div class="container-table100">
						<div class="wrap-table100">
							<div class="table100">
								<table id="list">
									<thead>
										<tr class="table100-head">
											<th class="column1">Product Name</th>
											<th class="column2">Current Price</th>
											<th class="column3">Trading Place</th>
											<th class="column4">Phone Number</th>
											<th class="column5">Status</th>
											<th class="column6">Seller Name</th>
										</tr>
									</thead>
									<tbody>
										<template id="list-row">
											<tr onClick="clickRow(this)">
												<td class="column1"></td>
												<td class="column2"></td>
												<td class="column3"></td>
												<td class="column4"></td>
												<td class="column5"></td>
												<td class="column6"></td>
											</tr>
										</template>
									</tbody>
								</table>
							</div>
						</div>
					</div>



					<!--================ Start footer Area  =================-->
					<footer>
						<div class="footer-bottom">
							<div class="container">
								<div class="row d-flex">
									<p class="col-lg-12 footer-text text-center">
										Copyright &copy;
										<script>document.write(new Date().getFullYear());</script>
										<i class="fa fa-heart" aria-hidden="true"></i> by Choi Ji Hye & Ju Hye Won
									</p>
								</div>
							</div>
						</div>
					</footer>
					<!--================ End footer Area  =================-->
				</div>
			</div>
		</div>
	</section>


	<!--===============================================================================================-->

	<script src="../vendors/jquery/jquery-3.2.1.min.js"></script>
	<script src="../vendors/bootstrap/bootstrap.bundle.min.js"></script>
	<script src="../vendors/skrollr.min.js"></script>
	<script src="../vendors/owl-carousel/owl.carousel.min.js"></script>
	<script src="../vendors/nice-select/jquery.nice-select.min.js"></script>
	<!--script src="../vendors/nouislider/nouislider.min.js"></!--script-->
	<script src="../vendors/jquery.ajaxchimp.min.js"></script>
	<script src="../vendors/mail-script.js"></script>
	<script src="../js/main.js"></script>
	<!--===============================================================================================-->
	<script src="https://www.gstatic.com/firebasejs/5.5.3/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/5.5.3/firebase-firestore.js"></script>

	<script>
		// Your web app's Firebase configuration
		var firebaseConfig = {
			apiKey: "AIzaSyCfplFv26jJI7FF5jPWHaQE8fMtm0pSNSA",
			authDomain: "skku-flea-market.firebaseapp.com",
			projectId: "skku-flea-market",
			appId: "1:496880200582:web:34045356203e3d8d1e5a07"
		};
		// Initialize Firebase
		firebase.initializeApp(firebaseConfig);
	</script>

	<script>

		var db = firebase.firestore();
		var docList = [];

		db.collection("product")
			.get()
			.then(function (qs) {
				docList = qs.docs;
				qs.forEach(function (doc) {
					var target = document.getElementById('list-row');
					var clone = document.importNode(target.content, true);
					var tb = document.querySelector("tbody");
					td = clone.querySelectorAll("td");
					//console.log(doc.data());
					td[0].textContent = doc.data().pname;
					td[1].textContent = doc.data().price;
					td[2].textContent = doc.data().tradingplace;
					td[3].textContent = doc.data().phonenum;
					td[4].textContent = doc.data().status;
					td[5].textContent = doc.data().seller;

					//var type = doc.data().type;

					//console.log(type);
					tb.appendChild(clone);
				})
			})

		function clickRow(obj) {

			var row_idx = obj.rowIndex - 1;
			console.log(docList[row_idx].data().type);


			if (docList[row_idx].data().type == "fleamarket") {
				window.location.href = "../page-buyer/product-detail-flea-market.html?id=" + docList[row_idx].id;

			}
			else if (docList[row_idx].data().type == "auction") {
				window.location.href = "../page-buyer/product-detail-auction.html?id=" + docList[row_idx].id;

			}

		}
		function search(obj) {
			var table = document.getElementById("list");
			//or use :  var table = document.all.tableid;
			for (var i = table.rows.length - 1; i > 0; i--) {
				table.deleteRow(i);
			}

			var docList = [];
			var min = document.getElementById("min_price").value;
			var max = document.getElementById("max_price").value;

			db.collection("product")
				.where("price", "<=", parseInt(max))
				.where("price", ">=", parseInt(min))
				.orderBy("price")
				.get()
				.then(function (qs) {
					docList = qs.docs;

					qs.forEach(function (doc) {
						var target = document.getElementById('list-row');
						var clone = document.importNode(target.content, true);
						var tb = document.querySelector("tbody");
						td = clone.querySelectorAll("td");
						console.log(doc.data().price);
						td[0].textContent = doc.data().pname;
						td[1].textContent = doc.data().price;
						td[2].textContent = doc.data().tradingplace;
						td[3].textContent = doc.data().phonenum;
						td[4].textContent = doc.data().status;
						td[5].textContent = doc.data().seller;

						var type = doc.data().type;

						tb.appendChild(clone);
					})

				})
		}

	</script>

</body>

</html>